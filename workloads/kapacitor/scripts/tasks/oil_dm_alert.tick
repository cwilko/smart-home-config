dbrp "telegraf"."autogen"

var data = stream
    // Select the oil measurement from the `telegraf` database.
    |from()
        .measurement('oil')
    
data
    // Triggers a critical alert when the oil stats are not received for more than 1h
    |deadman(0.0, 1h)
        .stateChangesOnly()
        .topic('system')
        .message('No oil tank measurments received in the past hour')
        .log('/tmp/alerts.log')